# 3 Vulnerability Analysis

---
**Copyright Notice**: The copyright holders of PTES and PTES-G maintain their copyrights. This is an open-source project to update the Guidelines.  
**Author**: Encrypter15, email: encrypter15@gmail.com maintains and asserts no rights to the information contained.  
**Date**: 2025-04-09  
**License**: This project is released under the MIT License as an open-source update to the PTES Technical Guidelines.  
---


This section focuses on identifying vulnerabilities using the best tools available in 2025. It’s a critical phase where reconnaissance data is leveraged to pinpoint weaknesses in the target environment.

## 3.1 Vulnerability Testing
### 3.1.1 Active
- **Approach**: Actively probe the target to identify vulnerabilities, such as open ports or misconfigured services.
- **Usage**: Employ tools like Nmap or Nessus (detailed below) for scanning. Begin with stealth scans to minimize detection risk.

### 3.1.2 Automated Tools
#### 3.1.2.1 Network/General Vulnerability Scanners
- **Tool**: Nessus Professional 2025
- **Usage**: Download from tenable.com and install on Windows or Linux. Launch the application, create a new scan, select 'Basic Network Scan', input the target range (e.g., `192.168.1.0/24`), and click 'Run'. Review results in the GUI, prioritizing 'High' severity issues. Update plugins daily with `nessuscli update`.

#### 3.1.2.2 Open Vulnerability Assessment System (OpenVAS) (Linux)
- **Tool**: OpenVAS 2025 (Greenbone Community Edition)
- **Usage**: Install on a Linux system (e.g., Kali) with `sudo apt install openvas`. Sync the latest feeds using `sudo greenbone-nvt-sync`, then configure with `openvas-setup`. Start the service with `sudo openvas-start`, access the web interface at `https://localhost:9392`, log in, and create a scan task for the target (e.g., `10.0.0.0/24`). Analyze the resulting vulnerability report.

#### 3.1.2.3 Nessus (Windows/Linux)
- **Tool**: Nessus Professional 2025
- **Usage**: Follow the same installation and scanning process as above. Use predefined policies like 'Basic' for initial scans before customizing.

#### 3.1.2.4 NeXpose
- **Tool**: Rapid7 InsightVM 2025
- **Usage**: Download from rapid7.com and install on a VM or server. Log into the web console, create a site with the target range (e.g., `192.168.1.0/24`), and initiate a scan by clicking 'Scan Now'. Review the results, which include risks and remediation steps.

#### 3.1.2.5 eEYE Retina
- **Tool**: BeyondTrust Retina CS 2025
- **Usage**: Install from beyondtrust.com, preferably on Windows. Launch the software, add assets (e.g., an IP range), and run a 'Full Audit' scan. Check the dashboard for vulnerability counts, focusing on high-priority issues.

#### 3.1.2.6 Qualys
- **Tool**: Qualys Vulnerability Management 2025
- **Usage**: Sign up at qualys.com, add target IPs in the web portal, and launch a scan. Review the results, prioritizing vulnerabilities with CVSS scores of 8.0 or higher.

#### 3.1.2.7 Core IMPACT
- **Tool**: Core Impact 2025
- **Usage**: Obtain from helpsystems.com and install on Windows. Create a new project, import targets (e.g., from an Nmap scan), and run a 'Network Penetration Test'. Examine findings in the 'Vulnerabilities' tab.
  ##### 3.1.2.7.1 Core IMPACT Web
  - **Usage**: Add a web target (e.g., `http://target.com`) in Core Impact, execute the 'Web Apps' module, and check the 'Exploited' section for successful vulnerabilities.
  ##### 3.1.2.7.2 Core IMPACT WiFi
  - **Usage**: Use with a supported Wi-Fi adapter and run the 'Wireless Pen Test' module. Monitor logs for captured keys.
  ##### 3.1.2.7.3 Core IMPACT Client Side
  - **Usage**: Create a phishing payload in the 'Client-Side Attack' module, distribute it, and review results for compromised hosts.
  ##### 3.1.2.7.4 Core Web
  - **Usage**: Similar to the Web module, focusing on web-specific vulnerabilities.
  ##### 3.1.2.7.5 coreWEBcrawl
  - **Usage**: Run prior to Web scans to crawl sites and identify hidden pages.
  ##### 3.1.2.7.6 Core Onestep Web RPTs
  - **Usage**: Generate one-click reports after scans for quick documentation.
  ##### 3.1.2.7.7 Core WiFi
  - **Usage**: Identical to the WiFi module, used for wireless-focused assessments.

#### 3.1.2.8 SAINT
- **Tool**: SAINT Security Suite 2025
- **Usage**: Install from saintcorporation.com on Linux or Windows. Create a scan job, input the target range, and execute. Review results, prioritizing high-risk vulnerabilities.
  ##### 3.1.2.8.1 SAINTscanner
  - **Usage**: Core scanning engine—follow the same setup as above.
  ##### 3.1.2.8.2 SAINTexploit
  - **Usage**: Enable the exploit module and run it post-scan to test identified vulnerabilities.
  ##### 3.1.2.8.3 SAINTwriter
  - **Usage**: Export scan results into reports formatted for technical or client use.

### 3.1.3 Web Application Scanners
#### 3.1.3.1 General Web Application Scanners
##### 3.1.3.1.1 WebInspect (Windows)
- **Tool**: HCL AppScan 2025 (WebInspect successor)
- **Usage**: Install on Windows, launch the application, add a URL (e.g., `http://target.com`), and run a 'Standard Scan'. Review the 'Issues' tab for vulnerabilities like XSS or SQL injection.
##### 3.1.3.1.2 IBM AppScan
- **Tool**: HCL AppScan 2025 (IBM rebrand)
- **Usage**: Install and follow the same process as above to scan and review web application vulnerabilities.
##### 3.1.3.1.3 Web Directory Listing/Bruteforcing
- **Tool**: DirBuster 2025
- **Usage**: Install with `sudo apt install dirbuster`, launch the GUI, input a URL, select a wordlist (e.g., `directory-list-2.3-medium.txt`), and initiate a brute-force scan for directories.
##### 3.1.3.1.4 Webserver Version/Vulnerability Identification
- **Tool**: Nikto 2.5
- **Usage**: Install with `sudo apt install nikto`, then run `nikto -h http://target.com` to identify server versions and vulnerabilities.

#### 3.1.3.2 NetSparker (Windows)
- **Tool**: Invicti 2025 (NetSparker rebrand)
- **Usage**: Install on Windows, enter a target URL, and run a scan. Review results for confirmed vulnerabilities.

#### 3.1.3.3 Specialized Vulnerability Scanners
##### 3.1.3.3.1 Virtual Private Networking (VPN)
- **Tool**: OpenVPN Scanner (Custom)
- **Usage**: Execute `python openvpn_scanner.py --target 192.168.1.10` to probe VPN configurations for weaknesses.
##### 3.1.3.3.2 IPv6
- **Tool**: THC-IPv6 2025
- **Usage**: Install with `sudo apt install thc-ipv6`, then run `thc-ipv6 -s 2001:db8::/64` to scan IPv6 ranges.
##### 3.1.3.3.3 War Dialing
- **Tool**: WarVOX 2025
- **Usage**: Install on Linux, configure a VoIP trunk, and run `warvox --range 555-123-0000-9999` to dial and detect modems.

### 3.1.4 Passive Testing
#### 3.1.4.1 Automated Tools
##### 3.1.4.1.1 Traffic Monitoring
- **Tool**: tcpdump 4.99.x
- **Usage**: Install with `sudo apt install tcpdump`, then capture traffic with `sudo tcpdump -i eth0 -w capture.pcap`.
#### 3.1.4.2 Wireshark
- **Tool**: Wireshark 4.x
- **Usage**: Install with `sudo apt install wireshark`, launch, select an interface (e.g., `eth0`), apply a filter (e.g., `http.request`), and analyze traffic.
#### 3.1.4.3 Tcpdump
- **Tool**: tcpdump 4.99.x
- **Usage**: Run `sudo tcpdump -i wlan0 host 192.168.1.10` to capture specific host traffic.
#### 3.1.4.4 Metasploit Scanners
##### 3.1.4.4.1 Metasploit Unleashed
- **Tool**: Metasploit Framework 6.x
- **Usage**: Launch with `msfconsole`, use the module `auxiliary/scanner/http/http_version`, set `RHOSTS 192.168.1.0/24`, and execute with `run`.

## 3.2 Vulnerability Validation
### 3.2.1 Public Research
#### 3.2.1.1 Common/Default Passwords
- **Tool**: Hydra 9.x
- **Usage**: Install with `sudo apt install hydra`, then run `hydra -L users.txt -P passwords.txt 192.168.1.10 ssh` to test default credentials.

### 3.2.2 Establish Target List
#### 3.2.2.1 Mapping Versions
- **Tool**: Nmap 7.95
- **Usage**: Run `nmap -sV 192.168.1.0/24` to map service versions for vulnerability correlation.
#### 3.2.2.2 Identifying Patch Levels
- **Tool**: OpenVAS 2025
- **Usage**: Perform a scan as described above and review the 'Patch Missing' section in the results.
#### 3.2.2.3 Looking for Weak Web Applications
- **Tool**: Burp Suite Pro 2025.x
- **Usage**: Proxy a website through Burp, crawl with the 'Spider' tool, and scan with the 'Scanner' module to identify weak applications.
#### 3.2.2.4 Identify Weak Ports and Services
- **Tool**: Nmap 7.95
- **Usage**: Run `nmap -p- -sV 192.168.1.10` to detect potentially vulnerable ports and services (e.g., Telnet on port 23).
#### 3.2.2.5 Identify Lockout Threshold
- **Tool**: Hydra 9.x
- **Usage**: Test with `hydra -l admin -P passwords.txt 192.168.1.10 http-post-form` to determine the number of failed attempts before account lockout.

## 3.3 Attack Avenues
### 3.3.1 Creation of Attack Trees
- **Approach**: Map potential attack paths from identified vulnerabilities to objectives (e.g., data exfiltration).
- **Usage**: Use scan results (e.g., from Nessus) to link vulnerabilities to exploitable conditions (e.g., CVE-2025-1234 to a Metasploit module).

### 3.3.2 Identify Protection Mechanisms
#### 3.3.2.1 Network Protections
##### 3.3.2.1.1 'Simple' Packet Filters
- **Tool**: Nmap 7.95
- **Usage**: Run `nmap -sA 192.168.1.10` to detect the presence of packet filters or firewalls via an ACK scan.
##### 3.3.2.1.2 Traffic Shaping Devices
- **Tool**: Wireshark 4.x
- **Usage**: Capture traffic on an interface (e.g., `wlan0`) and analyze for quality-of-service delays indicative of traffic shaping.
##### 3.3.2.1.3 Data Loss Prevention (DLP) Systems
- **Tool**: Custom Scripts
- **Usage**: Send test data with `echo 'SSN: 123-45-6789' | nc 192.168.1.10 80` and monitor for blocking behavior.

#### 3.3.2.2 Host Based Protections
##### 3.3.2.2.1 Stack/Heap Protections
- **Tool**: Checksec 2025
- **Usage**: Run `checksec --file binary` on a target executable to identify protections like ASLR or NX.
##### 3.3.2.2.2 Whitelisting
- **Tool**: Process Explorer (Windows)
- **Usage**: Launch on the target system and review the list of allowed applications to detect whitelisting enforcement.
##### 3.3.2.2.3 AV/Filtering/Behavioral Analysis
- **Tool**: EICAR Test File
- **Usage**: Place the EICAR test file (`eicar.com`) on the target and observe antivirus response.

#### 3.3.2.3 Application Level Protections
- **Tool**: Burp Suite Pro 2025.x
- **Usage**: Proxy application traffic through Burp and test for web application firewalls by sending payloads (e.g., `<script>alert(1)</script>`).

